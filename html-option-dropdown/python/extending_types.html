

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extending pyarrow &#8212; Apache Arrow v3.0.0.dev641+ge8678380d</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.5d5914fd1cc083e2424bb9c5e974de8e.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.90951cbc93101d5860c0.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using pyarrow from C++ and Cython Code" href="extending.html" />
    <link rel="prev" title="CUDA Integration" href="cuda.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">

    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z"/>
          <line x1="4" y1="6" x2="20" y2="6" />
          <line x1="10" y1="12" x2="20" y2="12" />
          <line x1="6" y1="18" x2="20" y2="18" />
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
    </svg>
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">


    
      
      <a class="navbar-brand" href="../index.html">
        <img src="../_static/arrow.png" class="logo" alt="logo">
      </a>
      
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    

      <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
        <ul id="navbar-main-elements" class="navbar-nav mr-auto">
          <li class="toctree-l1  nav-item">
            <a class="reference internal nav-link" href="../format.html">
              Specifications and Protocols
            </a>
          </li>
  
          <li class="toctree-l1 active nav-item dropdown">
            <a class="reference internal nav-link dropdown-toggle" href="#"
            id="navbarDropdownLibraries" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
              Libraries
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownGetArrow">
              <a class="reference internal nav-link" href="../status.html">
                Implementation Status
               </a>
               <a class="reference external nav-link" href="https://arrow.apache.org/docs/c_glib/">
                C/GLib
               </a>
               <a class="reference internal nav-link" href="../cpp/index.html">
                C++
               </a>
               <a class="reference external nav-link" href="https://github.com/apache/arrow/blob/master/csharp/README.md">
                C#
               </a>
               <a class="reference external nav-link" href="https://godoc.org/github.com/apache/arrow/go/arrow">
                Go
               </a>
               <a class="reference internal nav-link" href="../java/index.html">
                Java
               </a>
               <a class="reference external nav-link" href="https://arrow.apache.org/docs/js/">
                JavaScript
               </a>
               <a class="reference external nav-link" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">
                Julia
               </a>
               <a class="reference external nav-link" href="https://github.com/apache/arrow/blob/master/matlab/README.md">
                MATLAB
               </a>
               <a class="reference internal nav-link" href="index.html">
                Python
               </a>
               <a class="reference external nav-link" href="https://arrow.apache.org/docs/r/">
                R
               </a>
               <a class="reference external nav-link" href="https://github.com/apache/arrow/blob/master/ruby/README.md">
                Ruby
               </a>
               <a class="reference external nav-link" href="https://docs.rs/crate/arrow/">
                Rust
               </a>
              </div>
            </li>

          <li class="toctree-l1  nav-item">
            <a class="reference internal nav-link" href="../developers.html">
              Development
            </a>
          </li>
        </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/apache/arrow" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/ApacheArrow" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <!-- <ul class="nav bd-sidenav"> -->
      
      <ul class="current nav bd-sidenav testest">
 <li class="toctree-l3">
  <a class="reference internal" href="install.html">
   Installing PyArrow
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="memory.html">
   Memory and IO Interfaces
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="data.html">
   Data Types and In-Memory Data Model
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="compute.html">
   Compute Functions
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="ipc.html">
   Streaming, Serialization, and IPC
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="filesystems.html">
   Filesystem Interface
  </a>
 </li>
 <li class="toctree-l3 has-children">
  <a class="reference internal" href="filesystems_deprecated.html">
   Filesystem Interface (legacy)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.hdfs.connect.html">
     pyarrow.hdfs.connect
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.cat.html">
     pyarrow.HadoopFileSystem.cat
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.chmod.html">
     pyarrow.HadoopFileSystem.chmod
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.chown.html">
     pyarrow.HadoopFileSystem.chown
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.delete.html">
     pyarrow.HadoopFileSystem.delete
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.df.html">
     pyarrow.HadoopFileSystem.df
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.disk_usage.html">
     pyarrow.HadoopFileSystem.disk_usage
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.download.html">
     pyarrow.HadoopFileSystem.download
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.exists.html">
     pyarrow.HadoopFileSystem.exists
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.get_capacity.html">
     pyarrow.HadoopFileSystem.get_capacity
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.get_space_used.html">
     pyarrow.HadoopFileSystem.get_space_used
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.info.html">
     pyarrow.HadoopFileSystem.info
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.ls.html">
     pyarrow.HadoopFileSystem.ls
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.mkdir.html">
     pyarrow.HadoopFileSystem.mkdir
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.open.html">
     pyarrow.HadoopFileSystem.open
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.rename.html">
     pyarrow.HadoopFileSystem.rename
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.rm.html">
     pyarrow.HadoopFileSystem.rm
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HadoopFileSystem.upload.html">
     pyarrow.HadoopFileSystem.upload
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="generated/pyarrow.HdfsFile.html">
     pyarrow.HdfsFile
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="plasma.html">
   The Plasma In-Memory Object Store
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="numpy.html">
   NumPy Integration
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="pandas.html">
   Pandas Integration
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="timestamps.html">
   Timestamps
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="csv.html">
   Reading CSV files
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="feather.html">
   Feather File Format
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="json.html">
   Reading JSON files
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="parquet.html">
   Reading and Writing the Apache Parquet Format
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="dataset.html">
   Tabular Datasets
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="cuda.html">
   CUDA Integration
  </a>
 </li>
 <li class="toctree-l3 current active current-page">
  <a class="current reference internal" href="#">
   Extending pyarrow
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="extending.html">
   Using pyarrow from C++ and Cython Code
  </a>
 </li>
 <li class="toctree-l3 has-children">
  <a class="reference internal" href="api.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul>
   <li class="toctree-l4">
    <a class="reference internal" href="api/datatypes.html">
     Data Types and Schemas
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/arrays.html">
     Arrays and Scalars
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/memory.html">
     Buffers and Memory
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/compute.html">
     Compute Functions
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/files.html">
     Streams and File Access
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/tables.html">
     Tables and Tensors
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/ipc.html">
     Serialization and IPC
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/flight.html">
     Arrow Flight
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/formats.html">
     Tabular File Formats
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/filesystems.html">
     Filesystems
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/dataset.html">
     Dataset
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/plasma.html">
     Plasma In-Memory Object Store
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/cuda.html">
     CUDA Integration
    </a>
   </li>
   <li class="toctree-l4">
    <a class="reference internal" href="api/misc.html">
     Miscellaneous
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="getting_involved.html">
   Getting Involved
  </a>
 </li>
 <li class="toctree-l3">
  <a class="reference internal" href="benchmarks.html">
   Benchmarks
  </a>
 </li>
</ul>
      
    <!-- </ul> -->
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#controlling-conversion-to-pyarrow-array-with-the-arrow-array-protocol">
   Controlling conversion to pyarrow.Array with the
   <code class="docutils literal notranslate">
    <span class="pre">
     __arrow_array__
    </span>
   </code>
   protocol
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-extension-types-user-defined-types">
   Defining extension types (“user-defined types”)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametrized-extension-type">
     Parametrized extension type
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#custom-extension-array-class">
     Custom extension array class
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conversion-to-pandas">
     Conversion to pandas
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="extending-pyarrow">
<span id="extending-types"></span><h1>Extending pyarrow<a class="headerlink" href="#extending-pyarrow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="controlling-conversion-to-pyarrow-array-with-the-arrow-array-protocol">
<h2>Controlling conversion to pyarrow.Array with the <code class="docutils literal notranslate"><span class="pre">__arrow_array__</span></code> protocol<a class="headerlink" href="#controlling-conversion-to-pyarrow-array-with-the-arrow-array-protocol" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="generated/pyarrow.array.html#pyarrow.array" title="pyarrow.array"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.array()</span></code></a> function has built-in support for Python sequences,
numpy arrays and pandas 1D objects (Series, Index, Categorical, ..) to convert
those to Arrow arrays. This can be extended for other array-like objects
by implementing the <code class="docutils literal notranslate"><span class="pre">__arrow_array__</span></code> method (similar to numpy’s <code class="docutils literal notranslate"><span class="pre">__array__</span></code>
protocol).</p>
<p>For example, to support conversion of your duck array class to an Arrow array,
define the <code class="docutils literal notranslate"><span class="pre">__arrow_array__</span></code> method to return an Arrow array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDuckArray</span><span class="p">:</span>

    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">__arrow_array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># convert the underlying array values to a pyarrow Array</span>
        <span class="kn">import</span> <span class="nn">pyarrow</span>
        <span class="k">return</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">__arrow_array__</span></code> method takes an optional <cite>type</cite> keyword which is passed
through from <a class="reference internal" href="generated/pyarrow.array.html#pyarrow.array" title="pyarrow.array"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.array()</span></code></a>. The method is allowed to return either
a <a class="reference internal" href="generated/pyarrow.Array.html#pyarrow.Array" title="pyarrow.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> or a <a class="reference internal" href="generated/pyarrow.ChunkedArray.html#pyarrow.ChunkedArray" title="pyarrow.ChunkedArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChunkedArray</span></code></a>.</p>
</div>
<div class="section" id="defining-extension-types-user-defined-types">
<h2>Defining extension types (“user-defined types”)<a class="headerlink" href="#defining-extension-types-user-defined-types" title="Permalink to this headline">¶</a></h2>
<p>Arrow has the notion of extension types in the metadata specification as a
possibility to extend the built-in types. This is done by annotating any of the
built-in Arrow logical types (the “storage type”) with a custom type name and
optional serialized representation (“ARROW:extension:name” and
“ARROW:extension:metadata” keys in the Field’s custom_metadata of an IPC
message).
See the <a class="reference internal" href="../format/Columnar.html#format-metadata-extension-types"><span class="std std-ref">Extension Types</span></a> section of the metadata
specification for more details.</p>
<p>Pyarrow allows you to define such extension types from Python.</p>
<p>There are currently two ways:</p>
<ul class="simple">
<li><p>Subclassing <a class="reference internal" href="generated/pyarrow.PyExtensionType.html#pyarrow.PyExtensionType" title="pyarrow.PyExtensionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyExtensionType</span></code></a>: the (de)serialization is based on pickle.
This is a good option for an extension type that is only used from Python.</p></li>
<li><p>Subclassing <a class="reference internal" href="generated/pyarrow.ExtensionType.html#pyarrow.ExtensionType" title="pyarrow.ExtensionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensionType</span></code></a>: this allows to give a custom
Python-independent name and serialized metadata, that can potentially be
recognized by other (non-Python) Arrow implementations such as PySpark.</p></li>
</ul>
<p>For example, we could define a custom UUID type for 128-bit numbers which can
be represented as <code class="docutils literal notranslate"><span class="pre">FixedSizeBinary</span></code> type with 16 bytes.
Using the first approach, we create a <code class="docutils literal notranslate"><span class="pre">UuidType</span></code> subclass, and implement the
<code class="docutils literal notranslate"><span class="pre">__reduce__</span></code> method to ensure the class can be properly pickled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UuidType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">UuidType</span><span class="p">,</span> <span class="p">()</span>
</pre></div>
</div>
<p>This can now be used to create arrays and tables holding the extension type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_type</span> <span class="o">=</span> <span class="n">UuidType</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_type</span><span class="o">.</span><span class="n">extension_name</span>
<span class="go">&#39;arrow.py_extension_type&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_type</span><span class="o">.</span><span class="n">storage_type</span>
<span class="go">FixedSizeBinaryType(fixed_size_binary[16])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">uuid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_array</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">bytes</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span> <span class="n">pa</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ExtensionArray</span><span class="o">.</span><span class="n">from_storage</span><span class="p">(</span><span class="n">uuid_type</span><span class="p">,</span> <span class="n">storage_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">&lt;pyarrow.lib.ExtensionArray object at 0x7f75c2f300a0&gt;</span>
<span class="go">[</span>
<span class="go">  A6861959108644B797664AEEE686B682,</span>
<span class="go">  718747F48E5F4058A7261E2B6B228BE8,</span>
<span class="go">  7FE201227D624D96A5CD8639DEF2A68B,</span>
<span class="go">  C6CA8C7F95744BFD9462A40B3F57A86C</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This array can be included in RecordBatches, sent over IPC and received in
another Python process. The custom UUID type will be preserved there, as long
as the definition of the class is available (the type can be unpickled).</p>
<p>For example, creating a RecordBatch and writing it to a stream using the
IPC protocol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatch</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">arr</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ext&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sink</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">BufferOutputStream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchStreamWriter</span><span class="p">(</span><span class="n">sink</span><span class="p">,</span> <span class="n">batch</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">write_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="n">sink</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</pre></div>
</div>
<p>and then reading it back yields the proper type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ipc</span><span class="o">.</span><span class="n">open_stream</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;ext&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span>
<span class="go">UuidType(extension&lt;arrow.py_extension_type&gt;)</span>
</pre></div>
</div>
<p>We can define the same type using the other option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UuidType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">ExtensionType</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">ExtensionType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s2">&quot;my_package.uuid&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__arrow_ext_serialize__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># since we don&#39;t have a parametrized type, we don&#39;t need extra</span>
        <span class="c1"># metadata to be deserialized</span>
        <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__arrow_ext_deserialize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_type</span><span class="p">,</span> <span class="n">serialized</span><span class="p">):</span>
        <span class="c1"># return an instance of this subclass given the serialized</span>
        <span class="c1"># metadata.</span>
        <span class="k">return</span> <span class="n">UuidType</span><span class="p">()</span>
</pre></div>
</div>
<p>This is a slightly longer implementation (you need to implement the special
methods <code class="docutils literal notranslate"><span class="pre">__arrow_ext_serialize__</span></code> and <code class="docutils literal notranslate"><span class="pre">__arrow_ext_deserialize__</span></code>), and the
extension type needs to be registered to be received through IPC (using
<a class="reference internal" href="generated/pyarrow.register_extension_type.html#pyarrow.register_extension_type" title="pyarrow.register_extension_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_extension_type()</span></code></a>), but it has
now a unique name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_type</span> <span class="o">=</span> <span class="n">UuidType</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uuid_type</span><span class="o">.</span><span class="n">extension_name</span>
<span class="go">&#39;my_package.uuid&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pa</span><span class="o">.</span><span class="n">register_extension_type</span><span class="p">(</span><span class="n">uuid_type</span><span class="p">)</span>
</pre></div>
</div>
<p>The receiving application doesn’t need to be Python but can still recognize
the extension type as a “uuid” type, if it has implemented its own extension
type to receive it.
If the type is not registered in the receiving application, it will fall back
to the storage type.</p>
<div class="section" id="parametrized-extension-type">
<h3>Parametrized extension type<a class="headerlink" href="#parametrized-extension-type" title="Permalink to this headline">¶</a></h3>
<p>The above example used a fixed storage type with no further metadata. But
more flexible, parametrized extension types are also possible.</p>
<p>The example given here implements an extension type for the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#time-span-representation">pandas “period”
data type</a>,
representing time spans (e.g., a frequency of a day, a month, a quarter, etc).
It is stored as an int64 array which is interpreted as the number of time spans
of the given frequency since 1970.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PeriodType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">ExtensionType</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>
        <span class="c1"># attributes need to be set first before calling</span>
        <span class="c1"># super init (as that calls serialize)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">ExtensionType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">(),</span> <span class="s1">&#39;my_package.period&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span>

    <span class="k">def</span> <span class="nf">__arrow_ext_serialize__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;freq=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__arrow_ext_deserialize__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">storage_type</span><span class="p">,</span> <span class="n">serialized</span><span class="p">):</span>
        <span class="c1"># return an instance of this subclass given the serialized</span>
        <span class="c1"># metadata.</span>
        <span class="n">serialized</span> <span class="o">=</span> <span class="n">serialized</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">serialized</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;freq=&quot;</span><span class="p">)</span>
        <span class="n">freq</span> <span class="o">=</span> <span class="n">serialized</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">PeriodType</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we ensure to store all information in the serialized metadata that is
needed to reconstruct the instance (in the <code class="docutils literal notranslate"><span class="pre">__arrow_ext_deserialize__</span></code> class
method), in this case the frequency string.</p>
<p>Note that, once created, the data type instance is considered immutable. If,
in the example above, the <code class="docutils literal notranslate"><span class="pre">freq</span></code> parameter would change after instantiation,
the reconstruction of the type instance after IPC will be incorrect.
In the example above, the <code class="docutils literal notranslate"><span class="pre">freq</span></code> parameter is therefore stored in a private
attribute with a public read-only property to access it.</p>
<p>Parametrized extension types are also possible using the pickle-based type
subclassing <a class="reference internal" href="generated/pyarrow.PyExtensionType.html#pyarrow.PyExtensionType" title="pyarrow.PyExtensionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyExtensionType</span></code></a>. The equivalent example for the period
data type from above would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PeriodType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">int64</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">freq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PeriodType</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,)</span>
</pre></div>
</div>
<p>Also the storage type does not need to be fixed but can be parametrized.</p>
</div>
<div class="section" id="custom-extension-array-class">
<h3>Custom extension array class<a class="headerlink" href="#custom-extension-array-class" title="Permalink to this headline">¶</a></h3>
<p>By default, all arrays with an extension type are constructed or deserialized into
a built-in <a class="reference internal" href="generated/pyarrow.ExtensionArray.html#pyarrow.ExtensionArray" title="pyarrow.ExtensionArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensionArray</span></code></a> object. Nevertheless, one could want to subclass
<a class="reference internal" href="generated/pyarrow.ExtensionArray.html#pyarrow.ExtensionArray" title="pyarrow.ExtensionArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensionArray</span></code></a> in order to add some custom logic specific to the extension
type. Arrow allows to do so by adding a special method <code class="docutils literal notranslate"><span class="pre">__arrow_ext_class__</span></code> to the
definition of the extension type.</p>
<p>For instance, let us consider the example from the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.13.0/user/quickstart.html">Numpy Quickstart</a> of points in 3D space.
We can store these as a fixed-size list, where we wish to be able to extract
the data as a 2-D Numpy array <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> without any copy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Point3DArray</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">ExtensionArray</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">to_numpy_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">Point3DType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pa</span><span class="o">.</span><span class="n">PyExtensionType</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">list_</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">float32</span><span class="p">(),</span> <span class="mi">3</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Point3DType</span><span class="p">,</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">__arrow_ext_class__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Point3DArray</span>
</pre></div>
</div>
<p>Arrays built using this extension type now have the expected custom array class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">storage</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">pa</span><span class="o">.</span><span class="n">list_</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">float32</span><span class="p">(),</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">ExtensionArray</span><span class="o">.</span><span class="n">from_storage</span><span class="p">(</span><span class="n">Point3DType</span><span class="p">(),</span> <span class="n">storage</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">&lt;__main__.Point3DArray object at 0x7f40dea80670&gt;</span>
<span class="go">[</span>
<span class="go">    [</span>
<span class="go">        1,</span>
<span class="go">        2,</span>
<span class="go">        3</span>
<span class="go">    ],</span>
<span class="go">    [</span>
<span class="go">        4,</span>
<span class="go">        5,</span>
<span class="go">        6</span>
<span class="go">    ]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>The additional methods in the extension class are then available to the user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">()</span>
<span class="go">array([[1., 2., 3.],</span>
<span class="go">   [4., 5., 6.]], dtype=float32)</span>
</pre></div>
</div>
<p>This array can be sent over IPC, received in another Python process, and the custom
extension array class will be preserved (as long as the definitions of the classes above
are available).</p>
<p>The same <code class="docutils literal notranslate"><span class="pre">__arrow_ext_class__</span></code> specialization can be used with custom types defined
by subclassing <a class="reference internal" href="generated/pyarrow.ExtensionType.html#pyarrow.ExtensionType" title="pyarrow.ExtensionType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensionType</span></code></a>.</p>
</div>
<div class="section" id="conversion-to-pandas">
<h3>Conversion to pandas<a class="headerlink" href="#conversion-to-pandas" title="Permalink to this headline">¶</a></h3>
<p>The conversion to pandas (in <a class="reference internal" href="generated/pyarrow.Table.html#pyarrow.Table.to_pandas" title="pyarrow.Table.to_pandas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_pandas()</span></code></a>) of columns with an
extension type can controlled in case there is a corresponding
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/development/extending.html#extension-types">pandas extension array</a>
for your extension type.</p>
<p>For this, the <a class="reference internal" href="generated/pyarrow.ExtensionType.html#pyarrow.ExtensionType.to_pandas_dtype" title="pyarrow.ExtensionType.to_pandas_dtype"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ExtensionType.to_pandas_dtype()</span></code></a> method needs to be
implemented, and should return a <code class="docutils literal notranslate"><span class="pre">pandas.api.extensions.ExtensionDtype</span></code>
subclass instance.</p>
<p>Using the pandas period type from above as example, this would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PeriodType</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">ExtensionType</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">to_pandas_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">PeriodDtype</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
</pre></div>
</div>
<p>Secondly, the pandas <code class="docutils literal notranslate"><span class="pre">ExtensionDtype</span></code> on its turn needs to have the
<code class="docutils literal notranslate"><span class="pre">__from_arrow__</span></code> method implemented: a method that given a pyarrow Array
or ChunkedArray of the extension type can construct the corresponding
pandas <code class="docutils literal notranslate"><span class="pre">ExtensionArray</span></code>. This method should have the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyExtensionDtype</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">ExtensionDtype</span><span class="p">):</span>
    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">__from_arrow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">:</span> <span class="n">pyarrow</span><span class="o">.</span><span class="n">Array</span><span class="o">/</span><span class="n">ChunkedArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pandas</span><span class="o">.</span><span class="n">ExtensionArray</span><span class="p">:</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>This way, you can control the conversion of a pyarrow <code class="docutils literal notranslate"><span class="pre">Array</span></code> of your pyarrow
extension type to a pandas <code class="docutils literal notranslate"><span class="pre">ExtensionArray</span></code> that can be stored in a DataFrame.</p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="cuda.html" title="previous page">CUDA Integration</a>
    <a class='right-next' id="next-link" href="extending.html" title="next page">Using pyarrow from C++ and Cython Code</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.90951cbc93101d5860c0.js"></script>


    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script>

  </body>
</html>