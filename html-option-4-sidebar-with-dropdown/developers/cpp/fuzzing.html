
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuzzing Arrow C++ &#8212; Apache Arrow v4.0.0.dev61+g99280bec3</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.5d5914fd1cc083e2424bb9c5e974de8e.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.53262f6c45881805bcf7.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Python Development" href="../python.html" />
    <link rel="prev" title="Conventions" href="conventions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">

    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z"/>
          <line x1="4" y1="6" x2="20" y2="6" />
          <line x1="10" y1="12" x2="20" y2="12" />
          <line x1="6" y1="18" x2="20" y2="18" />
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
    </svg>
    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/arrow.png" class="logo" alt="logo">
</a>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
    <i class="icon fas fa-search"></i>
    <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
  </form>

  
  

  <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Development
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        
        <a class="nav-link" href="../../format.html">Specifications and Protocols</a>
        
        <a class="nav-link" href="../../status.html">Implementation Status</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/c_glib/">C/GLib</a>
        
        <a class="nav-link" href="../../cpp/index.html">C++</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/csharp/README.md">C#</a>
        
        <a class="nav-link" href="https://godoc.org/github.com/apache/arrow/go/arrow">Go</a>
        
        <a class="nav-link" href="../../java/index.html">Java</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/js/">JavaScript</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">Julia</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/matlab/README.md">MATLAB</a>
        
        <a class="nav-link" href="../../python/index.html">Python</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/r/">R</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/ruby/README.md">Ruby</a>
        
        <a class="nav-link" href="https://docs.rs/crate/arrow/">Rust</a>
        
        <a class="nav-link" href="../../development.html">Development</a>
        
   </div>
  </div>

  <nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
    <div class="bd-toc-item active">
      <!-- <ul class="nav bd-sidenav"> -->
        <ul class="current nav bd-sidenav">
 <li class="toctree-l2">
  <a class="reference internal" href="../contributing.html">
   Contributing to Apache Arrow
  </a>
 </li>
 <li class="toctree-l2 current active has-children">
  <a class="reference internal" href="index.html">
   C++ Development
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l3">
    <a class="reference internal" href="building.html">
     Building Arrow C++
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="development.html">
     Development Guidelines
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="windows.html">
     Developing on Windows
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="conventions.html">
     Conventions
    </a>
   </li>
   <li class="toctree-l3 current active current-page">
    <a class="current reference internal" href="#">
     Fuzzing Arrow C++
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../python.html">
   Python Development
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../archery.html">
   Daily Development using Archery
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../crossbow.html">
   Packaging and Testing with Crossbow
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../docker.html">
   Running Docker Builds
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../benchmarks.html">
   Benchmarks
  </a>
 </li>
 <li class="toctree-l2">
  <a class="reference internal" href="../documentation.html">
   Building the Documentation
  </a>
 </li>
</ul>
      <!-- </ul> -->
    </div>

    <!-- <ul class="nav bd-sidenav">
        
        <li class="nav-item ">
            <a class="nav-link" href="../../format.html">Specifications and Protocols</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../status.html">Implementation Status</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/c_glib/">C/GLib</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../cpp/index.html">C++</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/csharp/README.md">C#</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://godoc.org/github.com/apache/arrow/go/arrow">Go</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../java/index.html">Java</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/js/">JavaScript</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">Julia</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/matlab/README.md">MATLAB</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../python/index.html">Python</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/r/">R</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/ruby/README.md">Ruby</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://docs.rs/crate/arrow/">Rust</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../../development.html">Development</a>
        </li>
        
    </ul> -->
  
  </nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fuzz-targets-and-utilities">
   Fuzz Targets and Utilities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-the-seed-corpus">
     Generating the seed corpus
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#continuous-fuzzing-infrastructure">
   Continuous fuzzing infrastructure
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reproducing-locally">
   Reproducing locally
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="fuzzing-arrow-c">
<h1>Fuzzing Arrow C++<a class="headerlink" href="#fuzzing-arrow-c" title="Permalink to this headline">¶</a></h1>
<p>To make the handling of invalid input more robust, we have enabled
fuzz testing on several parts of the Arrow C++ feature set, currently:</p>
<ul class="simple">
<li><p>the IPC stream format</p></li>
<li><p>the IPC file format</p></li>
<li><p>the Parquet file format</p></li>
</ul>
<p>We welcome any contribution to expand the scope of fuzz testing and cover
areas ingesting potentially invalid or malicious data.</p>
<div class="section" id="fuzz-targets-and-utilities">
<h2>Fuzz Targets and Utilities<a class="headerlink" href="#fuzz-targets-and-utilities" title="Permalink to this headline">¶</a></h2>
<p>By passing the <code class="docutils literal notranslate"><span class="pre">-DARROW_FUZZING=ON</span></code> CMake option, you will build
the fuzz targets corresponding to the aforementioned Arrow features, as well
as additional related utilities.</p>
<div class="section" id="generating-the-seed-corpus">
<h3>Generating the seed corpus<a class="headerlink" href="#generating-the-seed-corpus" title="Permalink to this headline">¶</a></h3>
<p>Fuzzing essentially explores the domain space by randomly mutating previously
tested inputs, without having any high-level understanding of the area being
fuzz-tested.  However, the domain space is so huge that this strategy alone
may fail to actually produce any “interesting” inputs.</p>
<p>To guide the process, it is therefore important to provide a <em>seed corpus</em>
of valid (or invalid, but remarkable) inputs from which the fuzzing
infrastructure can derive new inputs for testing.  A script is provided
to automate that task.  Assuming the fuzzing executables can be found in
<code class="docutils literal notranslate"><span class="pre">build/debug</span></code>, the seed corpus can be generated thusly:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ ./build-support/fuzzing/generate_corpuses.sh build/debug
</pre></div>
</div>
</div>
</div>
<div class="section" id="continuous-fuzzing-infrastructure">
<h2>Continuous fuzzing infrastructure<a class="headerlink" href="#continuous-fuzzing-infrastructure" title="Permalink to this headline">¶</a></h2>
<p>The process of fuzz testing is computationally intensive and therefore
benefits from dedicated computing facilities.  Arrow C++ is exercised by
the <a class="reference external" href="https://google.github.io/oss-fuzz/">OSS-Fuzz</a> continuous fuzzing infrastructure operated by Google.</p>
<p>Issues found by OSS-Fuzz are notified and available to a limited set of
<a class="reference external" href="https://github.com/google/oss-fuzz/blob/master/projects/arrow/project.yaml">core developers</a>.
If you are a Arrow core developer and want to be added to that list, you can
ask on the <a class="reference internal" href="../contributing.html#contributing"><span class="std std-ref">mailing-list</span></a>.</p>
</div>
<div class="section" id="reproducing-locally">
<h2>Reproducing locally<a class="headerlink" href="#reproducing-locally" title="Permalink to this headline">¶</a></h2>
<p>When a crash is found by fuzzing, it is often useful to download the data
used to produce the crash, and use it to reproduce the crash so as to debug
and investigate.</p>
<p>Assuming you are in a subdirectory inside <code class="docutils literal notranslate"><span class="pre">cpp</span></code>, the following command
would allow you to build the fuzz targets with debug information and the
various sanitizer checks enabled.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ cmake .. -GNinja <span class="se">\</span>
    -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug <span class="se">\</span>
    -DARROW_USE_ASAN<span class="o">=</span>on <span class="se">\</span>
    -DARROW_USE_UBSAN<span class="o">=</span>on <span class="se">\</span>
    -DARROW_FUZZING<span class="o">=</span>on
</pre></div>
</div>
<p>Then, assuming you have downloaded the crashing data file (let’s call it
<code class="docutils literal notranslate"><span class="pre">testcase-arrow-ipc-file-fuzz-123465</span></code>), you can reproduce the crash
by running the affected fuzz target on that file:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ build/debug/arrow-ipc-file-fuzz testcase-arrow-ipc-file-fuzz-123465
</pre></div>
</div>
<p>(you may want to run that command under a debugger so as to inspect the
program state more closely)</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="conventions.html" title="previous page">Conventions</a>
    <a class='right-next' id="next-link" href="../python.html" title="next page">Python Development</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.53262f6c45881805bcf7.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2016-2019 Apache Software Foundation.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>