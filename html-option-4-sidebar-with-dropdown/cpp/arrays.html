
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays &#8212; Apache Arrow v4.0.0.dev61+g99280bec3</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.5d5914fd1cc083e2424bb9c5e974de8e.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.53262f6c45881805bcf7.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Types" href="datatypes.html" />
    <link rel="prev" title="Memory Management" href="memory.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">

    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z"/>
          <line x1="4" y1="6" x2="20" y2="6" />
          <line x1="10" y1="12" x2="20" y2="12" />
          <line x1="6" y1="18" x2="20" y2="18" />
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
    </svg>
    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
<a class="navbar-brand" href="../index.html">
  <img src="../_static/arrow.png" class="logo" alt="logo">
</a>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
    <i class="icon fas fa-search"></i>
    <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
  </form>

  
  

  <div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      C++
    </button>
    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        
        <a class="nav-link" href="../format.html">Specifications and Protocols</a>
        
        <a class="nav-link" href="../status.html">Implementation Status</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/c_glib/">C/GLib</a>
        
        <a class="nav-link" href="index.html">C++</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/csharp/README.md">C#</a>
        
        <a class="nav-link" href="https://godoc.org/github.com/apache/arrow/go/arrow">Go</a>
        
        <a class="nav-link" href="../java/index.html">Java</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/js/">JavaScript</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">Julia</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/matlab/README.md">MATLAB</a>
        
        <a class="nav-link" href="../python/index.html">Python</a>
        
        <a class="nav-link" href="https://arrow.apache.org/docs/r/">R</a>
        
        <a class="nav-link" href="https://github.com/apache/arrow/blob/master/ruby/README.md">Ruby</a>
        
        <a class="nav-link" href="https://docs.rs/crate/arrow/">Rust</a>
        
        <a class="nav-link" href="../development.html">Development</a>
        
   </div>
  </div>

  <nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
    <div class="bd-toc-item active">
      <!-- <ul class="nav bd-sidenav"> -->
        <ul class="current nav bd-sidenav">
 <li class="toctree-l2 current active has-children">
  <a class="reference internal" href="getting_started.html">
   User Guide
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l3">
    <a class="reference internal" href="overview.html">
     High-Level Overview
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="conventions.html">
     Conventions
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="cmake.html">
     Using Arrow C++ in your own project
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="memory.html">
     Memory Management
    </a>
   </li>
   <li class="toctree-l3 current active current-page">
    <a class="current reference internal" href="#">
     Arrays
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="datatypes.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="tables.html">
     Tabular Data
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="compute.html">
     Compute Functions
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="io.html">
     Input / output and filesystems
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="ipc.html">
     Reading and writing the Arrow IPC format
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="parquet.html">
     Reading and writing Parquet files
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="csv.html">
     Reading CSV files
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="json.html">
     Reading JSON files
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="flight.html">
     Arrow Flight RPC
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l2 has-children">
  <a class="reference internal" href="examples/index.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul>
   <li class="toctree-l3">
    <a class="reference internal" href="examples/cmake_minimal_build.html">
     Minimal build using CMake
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="examples/row_columnar_conversion.html">
     Row to columnar conversion
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="examples/tuple_range_conversion.html">
     std::tuple-like ranges to Arrow
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l2 has-children">
  <a class="reference internal" href="api.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="icon">
    <svg>
     <use href="#svg-arrow-right">
     </use>
    </svg>
   </i>
  </label>
  <ul>
   <li class="toctree-l3">
    <a class="reference internal" href="api/support.html">
     Programming Support
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/memory.html">
     Memory (management)
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/datatype.html">
     Data Types
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/array.html">
     Arrays
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/scalar.html">
     Scalars
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/builder.html">
     Array Builders
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/table.html">
     Two-dimensional Datasets
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/c_abi.html">
     C Interfaces
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/compute.html">
     Compute Functions
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/tensor.html">
     Tensors
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/utilities.html">
     Utilities
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/io.html">
     Input / output
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/ipc.html">
     Arrow IPC
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/formats.html">
     File Formats
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/cuda.html">
     CUDA support
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/flight.html">
     Arrow Flight RPC
    </a>
   </li>
   <li class="toctree-l3">
    <a class="reference internal" href="api/filesystem.html">
     Filesystems
    </a>
   </li>
  </ul>
 </li>
</ul>
      <!-- </ul> -->
    </div>

    <!-- <ul class="nav bd-sidenav">
        
        <li class="nav-item ">
            <a class="nav-link" href="../format.html">Specifications and Protocols</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../status.html">Implementation Status</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/c_glib/">C/GLib</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="index.html">C++</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/csharp/README.md">C#</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://godoc.org/github.com/apache/arrow/go/arrow">Go</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../java/index.html">Java</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/js/">JavaScript</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/julia/Arrow/README.md">Julia</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/matlab/README.md">MATLAB</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../python/index.html">Python</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://arrow.apache.org/docs/r/">R</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://github.com/apache/arrow/blob/master/ruby/README.md">Ruby</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="https://docs.rs/crate/arrow/">Rust</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../development.html">Development</a>
        </li>
        
    </ul> -->
  
  </nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-an-array">
   Building an array
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#performance">
     Performance
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#size-limitations-and-recommendations">
   Size Limitations and Recommendations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chunked-arrays">
   Chunked Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slicing">
   Slicing
  </a>
 </li>
</ul>

</nav>


              
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="arrays">
<h1>Arrays<a class="headerlink" href="#arrays" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="api/array.html"><span class="doc">Array API reference</span></a></p>
</div>
<p>The central type in Arrow is the class <a class="reference internal" href="api/array.html#_CPPv4N5arrow5ArrayE" title="arrow::Array"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Array</span></code></a>.   An array
represents a known-length sequence of values all having the same type.
Internally, those values are represented by one or several buffers, the
number and meaning of which depend on the array’s data type, as documented
in <a class="reference internal" href="../format/Layout.html"><span class="doc">the Arrow data layout specification</span></a>.</p>
<p>Those buffers consist of the value data itself and an optional bitmap buffer
that indicates which array entries are null values.  The bitmap buffer
can be entirely omitted if the array is known to have zero null values.</p>
<p>There are concrete subclasses of <a class="reference internal" href="api/array.html#_CPPv4N5arrow5ArrayE" title="arrow::Array"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Array</span></code></a> for each data type,
that help you access individual values of the array.</p>
<div class="section" id="building-an-array">
<h2>Building an array<a class="headerlink" href="#building-an-array" title="Permalink to this headline">¶</a></h2>
<p>As Arrow objects are immutable, there are classes provided that help you
build these objects incrementally from third-party data.  These classes
are organized in a hierarchy around the <a class="reference internal" href="api/builder.html#_CPPv4N5arrow12ArrayBuilderE" title="arrow::ArrayBuilder"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::ArrayBuilder</span></code></a> base class,
with concrete subclasses tailored for each particular data type.</p>
<p>For example, to build an array of <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> elements, we can use the
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Int64Builder</span></code> class. In the following example, we build an array
of the range 1 to 8 where the element that should hold the value 4 is nulled:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">arrow</span><span class="o">::</span><span class="n">Int64Builder</span> <span class="n">builder</span><span class="p">;</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">AppendNull</span><span class="p">();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Array</span><span class="o">&gt;</span> <span class="n">array</span><span class="p">;</span>
<span class="n">arrow</span><span class="o">::</span><span class="n">Status</span> <span class="n">st</span> <span class="o">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Finish</span><span class="p">(</span><span class="o">&amp;</span><span class="n">array</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">st</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span> <span class="p">{</span>
   <span class="c1">// ... do something on array building failure</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The resulting Array (which can be casted to the concrete <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Int64Array</span></code>
subclass if you want to access its values) then consists of two
<a class="reference internal" href="api/memory.html#_CPPv4N5arrow6BufferE" title="arrow::Buffer"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Buffer</span></code></a>s.
The first buffer holds the null bitmap, which consists here of a single byte with
the bits <code class="docutils literal notranslate"><span class="pre">1|1|1|1|0|1|1|1</span></code>. As we use  <a class="reference external" href="https://en.wikipedia.org/wiki/Bit_numbering">least-significant bit (LSB) numbering</a>.
this indicates that the fourth entry in the array is null. The second
buffer is simply an <code class="docutils literal notranslate"><span class="pre">int64_t</span></code> array containing all the above values.
As the fourth entry is null, the value at that position in the buffer is
undefined.</p>
<p>Here is how you could access the concrete array’s contents:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Cast the Array to its actual type to access its data</span>
<span class="k">auto</span> <span class="n">int64_array</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">static_pointer_cast</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Int64Array</span><span class="o">&gt;</span><span class="p">(</span><span class="n">array</span><span class="p">);</span>

<span class="c1">// Get the pointer to the null bitmap.</span>
<span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span> <span class="n">null_bitmap</span> <span class="o">=</span> <span class="n">int64_array</span><span class="o">-&gt;</span><span class="n">null_bitmap_data</span><span class="p">();</span>

<span class="c1">// Get the pointer to the actual data</span>
<span class="k">const</span> <span class="kt">int64_t</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="n">int64_array</span><span class="o">-&gt;</span><span class="n">raw_values</span><span class="p">();</span>

<span class="c1">// Alternatively, given an array index, query its null bit and value directly</span>
<span class="kt">int64_t</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">int64_array</span><span class="o">-&gt;</span><span class="n">IsNull</span><span class="p">(</span><span class="n">index</span><span class="p">))</span> <span class="p">{</span>
   <span class="kt">int64_t</span> <span class="n">value</span> <span class="o">=</span> <span class="n">int64_array</span><span class="o">-&gt;</span><span class="n">Value</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Int64Array</span></code> (respectively <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::Int64Builder</span></code>) is
just a <code class="docutils literal notranslate"><span class="pre">typedef</span></code>, provided for convenience, of <code class="docutils literal notranslate"><span class="pre">arrow::NumericArray&lt;Int64Type&gt;</span></code>
(respectively <code class="docutils literal notranslate"><span class="pre">arrow::NumericBuilder&lt;Int64Type&gt;</span></code>).</p>
</div>
<div class="section" id="performance">
<h3>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h3>
<p>While it is possible to build an array value-by-value as in the example above,
to attain highest performance it is recommended to use the bulk appending
methods (usually named <code class="docutils literal notranslate"><span class="pre">AppendValues</span></code>) in the concrete <a class="reference internal" href="api/builder.html#_CPPv4N5arrow12ArrayBuilderE" title="arrow::ArrayBuilder"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::ArrayBuilder</span></code></a>
subclasses.</p>
<p>If you know the number of elements in advance, it is also recommended to
presize the working area by calling the <a class="reference internal" href="api/builder.html#_CPPv4N5arrow12ArrayBuilder6ResizeE7int64_t" title="arrow::ArrayBuilder::Resize"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Resize()</span></code></a>
or <a class="reference internal" href="api/builder.html#_CPPv4N5arrow12ArrayBuilder7ReserveE7int64_t" title="arrow::ArrayBuilder::Reserve"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">Reserve()</span></code></a> methods.</p>
<p>Here is how one could rewrite the above example to take advantage of those
APIs:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">arrow</span><span class="o">::</span><span class="n">Int64Builder</span> <span class="n">builder</span><span class="p">;</span>
<span class="c1">// Make place for 8 values in total</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="c1">// Bulk append the given values (with a null in 4th place as indicated by the</span>
<span class="c1">// validity vector)</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;</span> <span class="n">validity</span> <span class="o">=</span> <span class="p">{</span><span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">true</span><span class="p">};</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">};</span>
<span class="n">builder</span><span class="p">.</span><span class="n">AppendValues</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">validity</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Array</span><span class="o">&gt;</span> <span class="n">array</span><span class="p">;</span>
<span class="n">arrow</span><span class="o">::</span><span class="n">Status</span> <span class="n">st</span> <span class="o">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Finish</span><span class="p">(</span><span class="o">&amp;</span><span class="n">array</span><span class="p">);</span>
</pre></div>
</div>
<p>If you still must append values one by one, some concrete builder subclasses
have methods marked “Unsafe” that assume the working area has been correctly
presized, and offer higher performance in exchange:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">arrow</span><span class="o">::</span><span class="n">Int64Builder</span> <span class="n">builder</span><span class="p">;</span>
<span class="c1">// Make place for 8 values in total</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppendNull</span><span class="p">();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">UnsafeAppend</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Array</span><span class="o">&gt;</span> <span class="n">array</span><span class="p">;</span>
<span class="n">arrow</span><span class="o">::</span><span class="n">Status</span> <span class="n">st</span> <span class="o">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Finish</span><span class="p">(</span><span class="o">&amp;</span><span class="n">array</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="size-limitations-and-recommendations">
<h2>Size Limitations and Recommendations<a class="headerlink" href="#size-limitations-and-recommendations" title="Permalink to this headline">¶</a></h2>
<p>Some array types are structurally limited to 32-bit sizes.  This is the case
for list arrays (which can hold up to 2^31 elements), string arrays and binary
arrays (which can hold up to 2GB of binary data), at least.  Some other array
types can hold up to 2^63 elements in the C++ implementation, but other Arrow
implementations can have a 32-bit size limitation for those array types as well.</p>
<p>For these reasons, it is recommended that huge data be chunked in subsets of
more reasonable size.</p>
</div>
<div class="section" id="chunked-arrays">
<h2>Chunked Arrays<a class="headerlink" href="#chunked-arrays" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="api/array.html#_CPPv4N5arrow12ChunkedArrayE" title="arrow::ChunkedArray"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">arrow::ChunkedArray</span></code></a> is, like an array, a logical sequence of values;
but unlike a simple array, a chunked array does not require the entire sequence
to be physically contiguous in memory.  Also, the constituents of a chunked array
need not have the same size, but they must all have the same data type.</p>
<p>A chunked array is constructed by aggregating any number of arrays.  Here we’ll
build a chunked array with the same logical values as in the example above,
but in two separate chunks:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Array</span><span class="o">&gt;&gt;</span> <span class="n">chunks</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">Array</span><span class="o">&gt;</span> <span class="n">array</span><span class="p">;</span>

<span class="c1">// Build first chunk</span>
<span class="n">arrow</span><span class="o">::</span><span class="n">Int64Builder</span> <span class="n">builder</span><span class="p">;</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">builder</span><span class="p">.</span><span class="n">Finish</span><span class="p">(</span><span class="o">&amp;</span><span class="n">array</span><span class="p">).</span><span class="n">ok</span><span class="p">())</span> <span class="p">{</span>
   <span class="c1">// ... do something on array building failure</span>
<span class="p">}</span>
<span class="n">chunks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">array</span><span class="p">));</span>

<span class="c1">// Build second chunk</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Reset</span><span class="p">();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">AppendNull</span><span class="p">();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">builder</span><span class="p">.</span><span class="n">Finish</span><span class="p">(</span><span class="o">&amp;</span><span class="n">array</span><span class="p">).</span><span class="n">ok</span><span class="p">())</span> <span class="p">{</span>
   <span class="c1">// ... do something on array building failure</span>
<span class="p">}</span>
<span class="n">chunks</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">array</span><span class="p">));</span>

<span class="k">auto</span> <span class="n">chunked_array</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">arrow</span><span class="o">::</span><span class="n">ChunkedArray</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">chunks</span><span class="p">));</span>

<span class="n">assert</span><span class="p">(</span><span class="n">chunked_array</span><span class="o">-&gt;</span><span class="n">num_chunks</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">);</span>
<span class="c1">// Logical length in number of values</span>
<span class="n">assert</span><span class="p">(</span><span class="n">chunked_array</span><span class="o">-&gt;</span><span class="n">length</span><span class="p">()</span> <span class="o">==</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">assert</span><span class="p">(</span><span class="n">chunked_array</span><span class="o">-&gt;</span><span class="n">null_count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="slicing">
<h2>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">¶</a></h2>
<p>Like for physical memory buffers, it is possible to make zero-copy slices
of arrays and chunked arrays, to obtain an array or chunked array referring
to some logical subsequence of the data.  This is done by calling the
<a class="reference internal" href="api/array.html#_CPPv4NK5arrow5Array5SliceE7int64_t7int64_t" title="arrow::Array::Slice"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">arrow::Array::Slice()</span></code></a> and <a class="reference internal" href="api/array.html#_CPPv4NK5arrow12ChunkedArray5SliceE7int64_t7int64_t" title="arrow::ChunkedArray::Slice"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">arrow::ChunkedArray::Slice()</span></code></a> methods,
respectively.</p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="memory.html" title="previous page">Memory Management</a>
    <a class='right-next' id="next-link" href="datatypes.html" title="next page">Data Types</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.53262f6c45881805bcf7.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2016-2019 Apache Software Foundation.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>